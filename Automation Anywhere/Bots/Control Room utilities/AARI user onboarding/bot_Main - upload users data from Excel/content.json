{"triggers":[],"nodes":[{"uid":"8bbe8c14-77f4-4588-a7d7-6a3d3c3a9a6c","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"9ce9783f-7c85-4f1c-adc2-18f5bfcbb719","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"4a315d1e-4db4-4f37-82db-83f15eaa91aa","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Prompt user for path to Excel file"}}]},{"uid":"ba280dd5-7e24-48ac-bb13-7c05ffcce7ee","commandName":"ForFile","packageName":"Prompt","disabled":false,"attributes":[{"name":"promptCaption","value":{"type":"STRING","string":"Select input file"}},{"name":"promptMessage","value":{"type":"STRING","string":"Please select the Excel file containing data on users to be created"}}],"returnTo":{"type":"VARIABLE","variableName":"listFilePaths"}},{"uid":"327d0708-62b8-4875-be97-efca327adf3f","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Validate selection of a single Excel file"}}]},{"uid":"355ee07f-e072-445d-a5e5-a492398983e6","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"2579ea8b-4ae2-4691-bf99-b9fdd19f9085","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$listFilePaths[0]$"}}],"returnTo":{"type":"VARIABLE","variableName":"strPathToExcelFile"}}],"branches":[{"uid":"5973dfe1-cbe5-4a5e-be2b-73ae45a3e5fe","commandName":"else","packageName":"If","disabled":false,"children":[{"uid":"342bb312-f89e-4367-a321-9a5c4215e689","commandName":"throw","packageName":"ErrorHandler","disabled":false,"attributes":[{"name":"message","value":{"type":"STRING","string":"File selection failed - either a single files was not selected or the selected file is not an .xlsx file"}},{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}]}]}],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"NUMBER","expression":"$listFilePaths.List:size$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"NUMBER","number":"1"}}],"operatorAttribute":{"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$listFilePaths[0]$"}},{"name":"operator","value":{"type":"STRING","string":"INCLUDE"}},{"name":"value","value":{"type":"STRING","string":".xlsx"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"operator":"AND"},"value":{"type":"CONDITIONAL","conditionalName":"numberVariable","packageName":"Number"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Ask user to select Excel file"}}]},{"uid":"05542dc9-23a5-4938-9c1e-bfd81aeabf32","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"ebc25c70-fd93-4434-abb7-dedcbf8c48e0","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Import users data from Excel"}}]},{"uid":"7ec15408-d3d2-498d-bd02-b5e5a971d3ab","commandName":"runTask","packageName":"TaskBot","disabled":false,"attributes":[{"name":"taskbot","value":{"type":"TASKBOT","taskbotInput":{"type":"DICTIONARY","dictionary":[{"key":"strPathToExcelInputFile","value":{"type":"STRING","expression":"$strPathToExcelFile$"}}]},"taskbotFile":{"type":"FILE","string":"repository:///Automation%20Anywhere/Bots/Control%20Room%20utilities/AARI%20user%20onboarding/Subtask%201%20-%20read%20users%20data%20from%20Excel"}}},{"name":"repeatOption","value":{"type":"STRING","string":"DO_NOT_REPEAT"}},{"name":"delayNextRepetition","value":{"type":"BOOLEAN","boolean":false}},{"name":"continueOnError","value":{"type":"BOOLEAN","boolean":false}}],"returnTo":{"type":"DICTIONARY","dictionary":[{"key":"tblUsers","value":{"type":"VARIABLE","variableName":"tblUsers"}}]}},{"uid":"56c436b1-d1a3-4819-b61c-818cbc99de1f","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Get role names and IDs from API call"}}]},{"uid":"ab5bd404-c097-4a3d-88dd-d55aa7703bf4","commandName":"runTask","packageName":"TaskBot","disabled":false,"attributes":[{"name":"taskbot","value":{"type":"TASKBOT","taskbotInput":{"type":"DICTIONARY","dictionary":[]},"taskbotFile":{"type":"FILE","string":"repository:///Automation%20Anywhere/Bots/Control%20Room%20utilities/AARI%20user%20onboarding/Subtask%202%20-%20get%20role%20names%20and%20IDs%20from%20API"}}},{"name":"repeatOption","value":{"type":"STRING","string":"DO_NOT_REPEAT"}},{"name":"delayNextRepetition","value":{"type":"BOOLEAN","boolean":false}},{"name":"continueOnError","value":{"type":"BOOLEAN","boolean":false}}],"returnTo":{"type":"DICTIONARY","dictionary":[{"key":"dictRoles","value":{"type":"VARIABLE","variableName":"dictRoles"}}]}},{"uid":"0b12ad98-dbaf-4568-94a4-34663e25b1d4","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Get AARI team names and IDs from API call"}}]},{"uid":"736c1cd6-d590-4fe2-bfb6-4e813c277f4c","commandName":"runTask","packageName":"TaskBot","disabled":false,"attributes":[{"name":"taskbot","value":{"type":"TASKBOT","taskbotInput":{"type":"DICTIONARY","dictionary":[]},"taskbotFile":{"type":"FILE","string":"repository:///Automation%20Anywhere/Bots/Control%20Room%20utilities/AARI%20user%20onboarding/Subtask%203%20-%20get%20AARI%20team%20names%20and%20IDs"}}},{"name":"repeatOption","value":{"type":"STRING","string":"DO_NOT_REPEAT"}},{"name":"delayNextRepetition","value":{"type":"BOOLEAN","boolean":false}},{"name":"continueOnError","value":{"type":"BOOLEAN","boolean":false}}],"returnTo":{"type":"DICTIONARY","dictionary":[{"key":"dictTeamIds","value":{"type":"VARIABLE","variableName":"dictTeamIds"}}]}}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Extract data from Excel and Control Room APIs"}}]},{"uid":"84ef2eb2-e531-42aa-9901-672d35f0e15e","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"fad6e21d-d66d-41ce-84b6-cca8d6d9f48a","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"5c8aafd2-170f-4237-a46c-d2d5c2627ae0","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Decrement the row index for zero-based operations"}}]},{"uid":"3283a055-de8e-4ed5-8c3a-af9e07abb0dd","commandName":"decrement","packageName":"Number","disabled":false,"attributes":[{"name":"source","value":{"type":"NUMBER","expression":"$numTblUsersRowIndex$"}},{"name":"by","value":{"type":"NUMBER","number":"1"}}],"returnTo":{"type":"VARIABLE","variableName":"numTblUsersRowIndex"}},{"uid":"dcef000c-4e25-4f41-a9cb-a32c1d927891","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Create the user and get user ID and status information"}}]},{"uid":"4dda52aa-67fe-4c7b-8ad3-7777f345ef29","commandName":"runTask","packageName":"TaskBot","disabled":false,"attributes":[{"name":"taskbot","value":{"type":"TASKBOT","taskbotInput":{"type":"DICTIONARY","dictionary":[{"key":"tblUsers","value":{"type":"TABLE","expression":"$tblUsers$"}},{"key":"dictRoles","value":{"type":"DICTIONARY","expression":"$dictRoles$"}},{"key":"numTblUsersRowIndex","value":{"type":"NUMBER","expression":"$numTblUsersRowIndex$"}}]},"taskbotFile":{"type":"FILE","string":"repository:///Automation%20Anywhere/Bots/Control%20Room%20utilities/AARI%20user%20onboarding/Subtask%204%20-%20create%20user%20in%20Control%20Room"}}},{"name":"repeatOption","value":{"type":"STRING","string":"DO_NOT_REPEAT"}},{"name":"delayNextRepetition","value":{"type":"BOOLEAN","boolean":false}},{"name":"continueOnError","value":{"type":"BOOLEAN","boolean":false}}],"returnTo":{"type":"DICTIONARY","dictionary":[{"key":"isUserCreated","value":{"type":"VARIABLE","variableName":"isUserCreated"}},{"key":"strStatus","value":{"type":"VARIABLE","variableName":"strStatusUserCreation"}},{"key":"numUserId","value":{"type":"VARIABLE","variableName":"numUserId"}}]}},{"uid":"0031b004-9500-4d14-b631-35ce653ad9a9","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"If the user was created successfully, assign the user to AARI teams and get status information"}}]},{"uid":"088e9bb6-916f-4ba9-a327-9a6707876e7f","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"a5dc289f-c3fb-41c6-b971-fa6d08920526","commandName":"runTask","packageName":"TaskBot","disabled":false,"attributes":[{"name":"taskbot","value":{"type":"TASKBOT","taskbotInput":{"type":"DICTIONARY","dictionary":[{"key":"tblUsers","value":{"type":"TABLE","expression":"$tblUsers$"}},{"key":"numTblUsersRowIndex","value":{"type":"NUMBER","expression":"$numTblUsersRowIndex$"}},{"key":"numUserId","value":{"type":"NUMBER","expression":"$numUserId$"}},{"key":"dictTeamIds","value":{"type":"DICTIONARY","expression":"$dictTeamIds$"}}]},"taskbotFile":{"type":"FILE","string":"repository:///Automation%20Anywhere/Bots/Control%20Room%20utilities/AARI%20user%20onboarding/Subtask%205%20-%20assign%20user%20to%20AARI%20teams"}}},{"name":"repeatOption","value":{"type":"STRING","string":"DO_NOT_REPEAT"}},{"name":"delayNextRepetition","value":{"type":"BOOLEAN","boolean":false}},{"name":"continueOnError","value":{"type":"BOOLEAN","boolean":false}}],"returnTo":{"type":"DICTIONARY","dictionary":[{"key":"isUserAssigned","value":{"type":"VARIABLE","variableName":"isUserAssigned"}},{"key":"strStatus","value":{"type":"VARIABLE","variableName":"strStatusTeamAssignment"}},{"key":"dictTeamIds","value":{"type":"VARIABLE","variableName":"dictTeamIds"}}]}}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"BOOLEAN","expression":"$isUserCreated$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"BOOLEAN","boolean":true}}],"value":{"type":"CONDITIONAL","conditionalName":"booleanVariable","packageName":"Boolean"}}]},{"uid":"da2680d0-a91b-4001-87e7-56f2209d25e2","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Update status columns with data for this user"}}]},{"uid":"6f142c99-a21a-442c-9cc0-49e3acf95a2d","commandName":"setCellValue","packageName":"DataTable","disabled":false,"attributes":[{"name":"table","value":{"type":"VARIABLE","variableName":"tblUsers"}},{"name":"rowPosition","value":{"type":"NUMBER","expression":"$numTblUsersRowIndex$"}},{"name":"columnType","value":{"type":"STRING","string":"colName"}},{"name":"columnName","value":{"type":"STRING","string":"User created?"}},{"name":"value","value":{"type":"STRING","expression":"$isUserCreated.Boolean:toString$"}}]},{"uid":"9cbc6c96-939a-4b80-a3b2-b172e932e8b2","commandName":"setCellValue","packageName":"DataTable","disabled":false,"attributes":[{"name":"table","value":{"type":"VARIABLE","variableName":"tblUsers"}},{"name":"rowPosition","value":{"type":"NUMBER","expression":"$numTblUsersRowIndex$"}},{"name":"columnType","value":{"type":"STRING","string":"colName"}},{"name":"columnName","value":{"type":"STRING","string":"User creation details"}},{"name":"value","value":{"type":"STRING","expression":"$strStatusUserCreation$"}}]},{"uid":"5d3d23d3-408f-4b66-a13c-89fb9752e723","commandName":"setCellValue","packageName":"DataTable","disabled":false,"attributes":[{"name":"table","value":{"type":"VARIABLE","variableName":"tblUsers"}},{"name":"rowPosition","value":{"type":"NUMBER","expression":"$numTblUsersRowIndex$"}},{"name":"columnType","value":{"type":"STRING","string":"colName"}},{"name":"columnName","value":{"type":"STRING","string":"Teams assigned?"}},{"name":"value","value":{"type":"STRING","expression":"$isUserAssigned.Boolean:toString$"}}]},{"uid":"aba57351-1162-4792-8211-283b78cbcfff","commandName":"setCellValue","packageName":"DataTable","disabled":false,"attributes":[{"name":"table","value":{"type":"VARIABLE","variableName":"tblUsers"}},{"name":"rowPosition","value":{"type":"NUMBER","expression":"$numTblUsersRowIndex$"}},{"name":"columnType","value":{"type":"STRING","string":"colName"}},{"name":"columnName","value":{"type":"STRING","string":"Team assignment details"}},{"name":"value","value":{"type":"STRING","expression":"$strStatusTeamAssignment$"}}]}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"numTblUsersRowIndex"},"attributes":[{"name":"times","value":{"type":"NUMBER","expression":"$tblUsers.DataTable:rowCount$"}}],"value":{"type":"ITERATOR","iteratorName":"loop.iterators.times","packageName":"Loop"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Create each user and assign to AARI teams as required"}}]},{"uid":"4b32e4af-cfe6-461e-9c30-50466fcd375c","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"7cad3161-7f29-469f-b3af-ed08028a299c","commandName":"runTask","packageName":"TaskBot","disabled":false,"attributes":[{"name":"taskbot","value":{"type":"TASKBOT","taskbotInput":{"type":"DICTIONARY","dictionary":[{"key":"strPathToExcelInputFile","value":{"type":"STRING","expression":"$strPathToExcelFile$"}},{"key":"tblUsers","value":{"type":"TABLE","expression":"$tblUsers$"}}]},"taskbotFile":{"type":"FILE","string":"repository:///Automation%20Anywhere/Bots/Control%20Room%20utilities/AARI%20user%20onboarding/Subtask%206%20-%20update%20Excel%20with%20status%20information"}}},{"name":"repeatOption","value":{"type":"STRING","string":"DO_NOT_REPEAT"}},{"name":"delayNextRepetition","value":{"type":"BOOLEAN","boolean":false}},{"name":"continueOnError","value":{"type":"BOOLEAN","boolean":false}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Update Excel file with status information"}}]}],"branches":[{"uid":"91bd9a09-6718-47e1-9c35-79f12439b357","commandName":"catch","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"1e64fb54-1bb0-4382-b06d-348b9356cace","commandName":"messageBox","packageName":"MessageBox","disabled":false,"attributes":[{"name":"title","value":{"type":"STRING","string":"Automation Anywhere Enterprise Client"}},{"name":"content","value":{"type":"STRING","expression":"Exception in main bot at line number $numErrorLine.Number:toString$: $strErrorMessage$"}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":false}}]}],"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}],"returns":{"errorMessage":{"type":"VARIABLE","variableName":"strErrorMessage"},"errorLineNumber":{"type":"VARIABLE","variableName":"numErrorLine"}}}]}],"variables":[{"name":"tblUsers","description":"","type":"TABLE","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"TABLE","table":{"schema":[{"type":"STRING"}],"rows":[{"values":[{"type":"STRING","string":""}]}]}}},{"name":"strErrorMessage","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"numErrorLine","description":"","type":"NUMBER","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"NUMBER","number":"0"}},{"name":"dictRoles","description":"","type":"DICTIONARY","readOnly":false,"input":false,"output":false,"subtype":"NUMBER","defaultValue":{"type":"DICTIONARY","dictionary":[]}},{"name":"numTblUsersRowIndex","description":"","type":"NUMBER","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"NUMBER","number":"0"}},{"name":"isUserCreated","description":"","type":"BOOLEAN","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"BOOLEAN","boolean":false}},{"name":"isUserAssigned","description":"","type":"BOOLEAN","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"BOOLEAN","boolean":false}},{"name":"strStatusUserCreation","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"strStatusTeamAssignment","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"numUserId","description":"","type":"NUMBER","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"NUMBER","number":"0"}},{"name":"dictTeamIds","description":"","type":"DICTIONARY","readOnly":false,"input":false,"output":false,"subtype":"NUMBER","defaultValue":{"type":"DICTIONARY","dictionary":[]}},{"name":"listFilePaths","description":"","type":"LIST","readOnly":false,"input":false,"output":false,"subtype":"STRING","defaultValue":{"type":"LIST","list":[]}},{"name":"strPathToExcelFile","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}}],"breakpoints":[],"packages":[{"name":"Boolean","version":"2.1.0-20210227-025413"},{"name":"Comment","version":"2.5.0-20210227-025428"},{"name":"DataTable","version":"2.7.0-20210227-030044"},{"name":"ErrorHandler","version":"2.5.0-20210227-025450"},{"name":"If","version":"2.1.0-20210227-025501"},{"name":"List","version":"2.3.0-20210227-025719"},{"name":"Loop","version":"2.2.0-20210227-025721"},{"name":"MessageBox","version":"2.1.0-20210227-025722"},{"name":"Number","version":"2.3.0-20210227-025737"},{"name":"Prompt","version":"2.2.0-20210223-003045"},{"name":"Step","version":"2.0.1-20210304-145803"},{"name":"String","version":"3.3.0-20210227-030040"},{"name":"TaskBot","version":"2.0.1-20210210-232054"}],"migrationJournalReviewIds":[],"workItemTemplateName":null}